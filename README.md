# Receipt Processor

This Receipt Processor API is a Node.js application, which processes receipts and awards points based on defined rules. The API provides endpoints to submit receipts, retrieve points by ID, and get summaries of points for all processed receipts. Utilizing in-memory storage, the API ensures data persistence during its runtime.

---

## Table of Contents

- [Receipt Processor](#receipt-processor)
  - [Table of Contents](#table-of-contents)
- [Getting Started With Docker](#getting-started-with-docker)
- [Rules for Awarding Points](#rules-for-awarding-points)
- [Summary of API Specification](#summary-of-api-specification)
  - [Key Endpoints](#key-endpoints)
  - [Endpoint: Process Receipts](#endpoint-process-receipts)
  - [Endpoint: Get Points By ID](#endpoint-get-points-by-id)
  - [Endpoint: Get All Points](#endpoint-get-all-points)
  - [Endpoint: Get All Receipts](#endpoint-get-all-receipts)
  - [Endpoint: Get Receipt By ID](#endpoint-get-receipt-by-id)
- [Examples](#examples)

---

## Getting Started With Docker

1. Clone the repository to your local machine:
   `git clone https://github.com/clee4037/receipt-processor-challenge.git`
2. Navigate to the project directory
   `cd <path to repository>`
3. Build a Docker image and run tests
   `docker build -t clee4037/receipt-processor --progress=plain --no-cache --target test .`
4. Run Docker container
   `docker-compose up`
   Your Receipt Processor API will be running at http://localhost:8080
5. Stop Docker container
   `docker-compose down`

---

## Rules for Awarding Points

- Alphanumeric characters in retailer name: 1 point each.
- Total is a round dollar amount: 50 points.
- Total is a multiple of 0.25: 25 points.
- Every two items on the receipt: 5 points.
- Trimmed length of item description is a multiple of 3: Price multiplied by 0.2, rounded up.
- Day in the purchase date is odd: 6 points.
- Time of purchase is after 2:00 pm and before 4:00 pm: 10 points.

---

## Summary of API Specification

### Key Endpoints

Required

- `/receipts/process`: Submit a JSON receipt and receive an ID.
- `/receipts/:id/points`: Get points awarded for a receipt by its ID.

Additional

- `/receipts/points`: Get points awarded for all processed receipts.
- `/receipts`: Get all processed receipts.
- `/receipts/:id`: Get the contents of a processed receipt.

### Endpoint: Process Receipts

- Path: `/receipts/process`
- Method: `POST`
- Payload: Receipt JSON
- Response: JSON containing an id for the receipt.

Description:

Takes in a JSON receipt (see example in the example directory) and returns a JSON object with an ID generated by your code.

The ID returned is the ID that should be passed into `/receipts/{id}/points` to get the number of points the receipt
was awarded.

Example Response:

```json
{ "id": "7fb1377b-b223-49d9-a31a-5a02701dd310" }
```

### Endpoint: Get Points By ID

- Path: `/receipts/{id}/points`
- Method: `GET`
- Response: A JSON object containing the number of points awarded.

A simple Getter endpoint that looks up the receipt by the ID and returns an object specifying the points awarded.

Example Response:

```json
{ "points": 32 }
```

### Endpoint: Get All Points

- Path: `/receipts/points`
- Method: `GET`
- Response: A JSON object containing the number of points awarded of all processed receipts by ID.

A simple Getter endpoint that retrieves and returns an object specifying the points awarded for all processed receipts.

Example Response:

```json
{
  "example-id-1": 109,
  "example-id-2": 32,
  "example-id-3": 8
}
```

### Endpoint: Get All Receipts

- Path: `/receipts`
- Method: `GET`
- Response: A JSON object containing all processed receipts by ID.

A simple Getter endpoint that retrieves and returns an object of all processed receipts.

Example Response:

```json
{
  "example-id": {
    "retailer": "M&M Corner Market",
    "purchaseDate": "2022-03-20",
    "purchaseTime": "14:33",
    "items": [
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      }
    ],
    "total": "9.00"
  },
  "c26b811c-7faa-4dd6-b42c-a9526fcda19e": {
    "retailer": "Walgreens",
    "purchaseDate": "2022-01-02",
    "purchaseTime": "08:13",
    "total": "2.65",
    "items": [
      {
        "shortDescription": "Pepsi - 12-oz",
        "price": "1.25"
      },
      {
        "shortDescription": "Dasani",
        "price": "1.40"
      }
    ]
  }
}
```

### Endpoint: Get Receipt By ID

- Path: `/receipts/:id`
- Method: `GET`
- Response: A JSON object containing the contents of a processed receipt.

A simple Getter endpoint that looks up the receipt by the ID and returns an object containing its contents.

Example Response:

```json
{
  "receipt": {
    "retailer": "M&M Corner Market",
    "purchaseDate": "2022-03-20",
    "purchaseTime": "14:33",
    "items": [
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      },
      {
        "shortDescription": "Gatorade",
        "price": "2.25"
      }
    ],
    "total": "9.00"
  }
}
```

---

## Examples

```json
{
  "retailer": "Target",
  "purchaseDate": "2022-01-01",
  "purchaseTime": "13:01",
  "items": [
    {
      "shortDescription": "Mountain Dew 12PK",
      "price": "6.49"
    },
    {
      "shortDescription": "Emils Cheese Pizza",
      "price": "12.25"
    },
    {
      "shortDescription": "Knorr Creamy Chicken",
      "price": "1.26"
    },
    {
      "shortDescription": "Doritos Nacho Cheese",
      "price": "3.35"
    },
    {
      "shortDescription": "   Klarbrunn 12-PK 12 FL OZ  ",
      "price": "12.00"
    }
  ],
  "total": "35.35"
}
```

```text
Total Points: 28
Breakdown:
     6 points - retailer name has 6 characters
    10 points - 4 items (2 pairs @ 5 points each)
     3 Points - "Emils Cheese Pizza" is 18 characters (a multiple of 3)
                item price of 12.25 * 0.2 = 2.45, rounded up is 3 points
     3 Points - "Klarbrunn 12-PK 12 FL OZ" is 24 characters (a multiple of 3)
                item price of 12.00 * 0.2 = 2.4, rounded up is 3 points
     6 points - purchase day is odd
  + ---------
  = 28 points
```

---

```json
{
  "retailer": "M&M Corner Market",
  "purchaseDate": "2022-03-20",
  "purchaseTime": "14:33",
  "items": [
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    },
    {
      "shortDescription": "Gatorade",
      "price": "2.25"
    }
  ],
  "total": "9.00"
}
```

```text
Total Points: 109
Breakdown:
    50 points - total is a round dollar amount
    25 points - total is a multiple of 0.25
    14 points - retailer name (M&M Corner Market) has 14 alphanumeric characters
                note: '&' is not alphanumeric
    10 points - 2:33pm is between 2:00pm and 4:00pm
    10 points - 4 items (2 pairs @ 5 points each)
  + ---------
  = 109 points
```

---
